# Admin MCP Backend
apiVersion: gateway.kgateway.dev/v1alpha1
kind: Backend
metadata:
  name: admin-mcp-backend
spec:
  type: MCP
  mcp:
    targets:
    - name: admin-target
      static:
        host: mcp-admin-server.default.svc.cluster.local
        port: 80
        protocol: StreamableHTTP
---
# User MCP Backend  
apiVersion: gateway.kgateway.dev/v1alpha1
kind: Backend
metadata:
  name: user-mcp-backend
spec:
  type: MCP
  mcp:
    targets:
    - name: user-target
      static:
        host: mcp-website-fetcher.default.svc.cluster.local
        port: 80
        protocol: SSE
---
# HTTPRoute for dynamic MCP with header-based routing
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: dynamic-mcp-route
spec:
  parentRefs:
  - name: gw
  rules:
    # Admin route - matches requests with user-type: admin header
    - matches:
      - headers:
        - name: user-type
          value: admin
      backendRefs:
      - name: admin-mcp-backend
        group: gateway.kgateway.dev
        kind: Backend
    # User route - matches all other requests (default)
    - backendRefs:
      - name: user-mcp-backend
        group: gateway.kgateway.dev
        kind: Backend
